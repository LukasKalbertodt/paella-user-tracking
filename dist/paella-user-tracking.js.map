{"version":3,"file":"paella-user-tracking.js","mappings":"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","sources":["webpack://paella-user-tracking/webpack/universalModuleDefinition","webpack://paella-user-tracking/./src/plugins/UserTrackingPlugins.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.analytics.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.debug.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.debugTag.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.matomo.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.userEventTracker.js","webpack://paella-user-tracking/./src/plugins/ sync \\.js","webpack://paella-user-tracking/external umd {\"commonjs\":\"paella-core\",\"commonjs2\":\"paella-core\",\"amd\":\"paella-core\"}","webpack://paella-user-tracking/webpack/bootstrap","webpack://paella-user-tracking/webpack/runtime/compat get default export","webpack://paella-user-tracking/webpack/runtime/define property getters","webpack://paella-user-tracking/webpack/runtime/hasOwnProperty shorthand","webpack://paella-user-tracking/webpack/runtime/make namespace object","webpack://paella-user-tracking/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"paella-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"paella-core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"paella-user-tracking\"] = factory(require(\"paella-core\"));\n\telse\n\t\troot[\"paella-user-tracking\"] = factory(root[undefined]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__995__) => {\nreturn ","import { PluginModule } from \"paella-core\";\nimport packageData from \"../../package.json\";\n\nexport default class UserTrackingPlugins extends PluginModule {\n    get moduleName() {\n        return \"paella-user-tracking\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","\nimport { DataPlugin  } from \"paella-core\";\n\nexport default class AnalyticsUserTrackingDataPlugin extends DataPlugin {\n    async load() {\n        const trackingId = this.config.trackingId;\n        const domain = this.config.domain || \"auto\";\n        if (trackingId) {\n            this.player.log.debug(\"Google Analytics Enabled\");\n            /* jshint ignore:start */\n            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n                (i[r].q=i[r].q||[]).push(arguments);},i[r].l=1*new Date();a=s.createElement(o),\n                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n                })(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');\n            /* jshint ignore:end */\n            __gaTracker('create', trackingId, domain);\n            __gaTracker('send', 'pageview');\n        }\n        else {\n            this.player.log.debug(\"No Google Tracking ID found in config file. Disabling Google Analytics\");\n        }\n    }\n    \n    async write(context, { id }, data) {\n        if (this.config.category === undefined || this.config.category === true) {\n            const category = this.config.category || \"PaellaPlayer\";\n            const action = data.event;\n            const labelData = {\n                videoId: id,\n                plugin: data.plugin\n            }\n\n            try {\n                // Test if data parameters can be serialized\n                JSON.stringify(data.params);\n                labelData.params = data.params;\n            }\n            catch(e) {}\n\n            const label = JSON.stringify(labelData);\n\n            __gaTracker(' send', 'event', category, action, label);\n        }\n    }\n}","\nimport { DataPlugin } from 'paella-core';\n\nexport default class DebugUserTrackingDataPlugin extends DataPlugin {\n    async write(context, { id }, data) {\n        console.log(`id: ${ id }`, context, data);\n    }\n}\n","\nimport { DataPlugin } from 'paella-core';\n\nexport default class DebugTagTrackingDataPlugin extends DataPlugin {\n\n    async load() {\n        if (this.config.tagId) {\n            this._elem = document.getElementById(this.config.tagId);\n        }\n    }\n\n    async write(context, { id }, data) {\n        if (this._elem) {\n            this._elem.innerHTML += '<br/>' + id + \" \" + data.event;\n        }\n    }\n}","\nimport { DataPlugin, Events, bindEvent  } from \"paella-core\";\n\nexport default class MatomoUserTrackingDataPlugin extends DataPlugin {\n    \n    async isEnabled() {\n        if (!(await super.isEnabled())) {\n          return false;\n        }\n        else {\n            this.matomoGlobalLoaded = this.config.matomoGlobalLoaded ?? false;\n            this.server = this.config.server;\n            this.siteId = this.config.siteId;\n            this.events = this.config.events;\n            \n            if (!this.matomoGlobalLoaded && !(this.server && this.siteId)) {\n                this.player.log.warn('Matomo plugin: Plugin is enabled, but is not configured correctly. Please configue `matomoGlobalLoaded`, `server`and `siteId` parameters.');\n                return false;\n            }\n            return true;\n        }\n    }\n\n    async getCurrentUserId() {\n        return null;\n    }\n\n    async trackCustomDimensions() {\n        const templateVars = await this.getTemplateVars();\n        const customDimensions = this.config.customDimensions ?? {};\n\n        try {\n            Object.entries(customDimensions).forEach(([customDimensionId, customDimensionValueTemplate]) => {\n                const customDimensionValue = this.applyTemplate(customDimensionValueTemplate, templateVars);\n                _paq.push(['setCustomDimension', customDimensionId, customDimensionValue]);\n                this.player.log.debug(`Matomo plugin: setting custom dimension id=${customDimensionId} to '${customDimensionValue}'`);\n            });\n        }\n        catch(e) {            \n        }\n    }\n\n    async getTemplateVars(data) {\n        let eventData = this.getEventData(data);\n\n        return {\n            videoId: this.player._videoId,\n            metadata: this.player.videoManifest.metadata,\n            event: data?.event || '',\n            eventData: eventData\n        };\n    }\n\n    getEventData(data) {\n\n        switch (data?.event) {\n            case Events.SEEK:\n                return Math.round(data.params.newTime);\n            case Events.VOLUME_CHANGED:\n                return data.params.volume*100;\n            case Events.BUTTON_PRESS:\n                return data.params.plugin.name;\n            case Events.SHOW_POPUP:\n                return data.params.plugin.name;\n            case Events.HIDE_POPUP:\n                return data.params.plugin.name;\n            case Events.RESIZE_END:\n                return `${ data.params.size.w }x${ data.params.size.h }`;\n            case Events.LAYOUT_CHANGED:\n                return data.params.layoutId;\n            case Events.PLAYBACK_RATE_CHANGED:\n                return data.params.newPlaybackRate;\n            case Events.CAPTIONS_ENABLED:\n                return data.params.language;\n        }\n\n        return '';\n    }\n\n    async load() {\n        const heartBeatTime = this.config.heartBeatTime || 15;\n\n        var _paq = window._paq = window._paq || [];\n        // _paq.push(['requireConsent']);\n        _paq.push(['requireCookieConsent']);\n        bindEvent(this.player, Events.COOKIE_CONSENT_CHANGED, () => {\n            this.player.log.debug('Matomo: Cookie consent changed.');\n            if (this.player.cookieConsent.getConsentForType(this.config.cookieType)) {\n                // _paq.push(['rememberConsentGiven']);\n                _paq.push(['rememberCookieConsentGiven']);\n            }\n            else {\n                // _paq.push(['forgetConsentGiven']);\n                _paq.push(['forgetCookieConsentGiven']);\n            }\n        });\n        \n        \n        if (this.matomoGlobalLoaded) {\n            var _paq = window._paq = window._paq || [];\n            this.player.log.debug('Assuming Matomo analytics is initialized globaly.');\n            if (server) {\n                this.player.log.warn('Matomo plugin: `server` parameter is defined, but never used because Matomo is loaded globaly in the page. Is it an error? Please check it.');\n            }\n            if (siteId) {\n                this.player.log.warn('Matomo plugin: `siteId` parameter is defined, but never used because Matomo is loaded globaly in the page. Is it an error? Please check it.');\n            }\n        }\n        else {\n            const server = this.server;\n            const siteId = this.siteId;            \n            this.player.log.debug(\"Matomo analytics plugin enabled.\");\n            this.trackCustomDimensions();\n            const userId =  await this.getCurrentUserId();\n            if (userId) {\n                _paq.push(['setUserId', userId]);\n            }\n            _paq.push(['trackPageView']);\n            _paq.push(['enableLinkTracking']);\n            (function() {\n                var u=server;\n                _paq.push(['setTrackerUrl', u+'matomo.php']);\n                _paq.push(['setSiteId', siteId]);\n                var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];\n                g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);\n            })();\n        }\n        // accurately measure the time spent in the visit\n        _paq.push(['enableHeartBeatTimer', heartBeatTime]);\n        this.trackCustomDimensions();\n        // Scan For Media\n        bindEvent(this.player, Events.STREAM_LOADED, () => {\n            _paq.push(['MediaAnalytics::scanForMedia']);\n        });\n    }\n    \n    applyTemplate(txt, templateVars) {        \n        return txt.replace(/\\${[^{]*}/g, (t)=>{\n            return t.substring(2, t.length-1).split(\".\").reduce((a,b)=>{return a[b];}, templateVars)\n        });\n    };\n\n    async write(context, { id }, data) {\n        if (this.events) {\n            const categoryT = this.events.category || 'PaellaPlayer';\n            const actionT = this.events.action || '${event}';\n            const nameT = this.events.name || '${eventData}';\n\n            const templateVars = await this.getTemplateVars(data);\n\n            const category = this.applyTemplate(categoryT, templateVars);\n            const action = this.applyTemplate(actionT, templateVars);\n            const name = this.applyTemplate(nameT, templateVars);\n            \n            _paq.push(['trackEvent', category, action, name]);\n            this.player.log.debug(`Matomo plugin: track event category='${category}', action='${action}', name='${name}'`);\n        }\n    }\n}","import { Events, EventLogPlugin } from 'paella-core';\n\n//const eventKeys = Object.keys(Events);\n\nconst getPaellaEvents = (events) => events.map(eventName => Events[eventName]);\n\nexport default class UserEventTrackerPlugin extends EventLogPlugin {\n\tget events() {\n\t\tif (this.config.events) {\n\t\t\treturn getPaellaEvents(this.config.events);\n\t\t}\n\t\telse {\n\t\t\treturn [\n\t\t\t\tEvents.PLAY,\n\t\t\t\tEvents.PAUSE,\n\t\t\t\tEvents.SEEK,\n\t\t\t\tEvents.STOP,\n\t\t\t\tEvents.ENDED,\n\t\t\t\tEvents.FULLSCREEN_CHANGED,\n\t\t\t\tEvents.VOLUME_CHANGED,\n\t\t\t\tEvents.BUTTON_PRESS,\n\t\t\t\tEvents.RESIZE_END\n\t\t\t]\n\t\t}\n\t}\n\n\tasync onEvent(event, params) {\n\t\tconst id = this.player.videoId;\n\t\t// Remove plugin reference to avoid circular references\n\t\tif (params.plugin) {\n\t\t\tconst { name, config } = params.plugin;\n\t\t\tparams.plugin = { name, config }\n\t\t}\n\t\tconst trackingData = { event, params }\n\n\t\tswitch (event) {\n\t\tcase Events.SHOW_POPUP:\n\t\tcase Events.HIDE_POPUP:\n\t\tcase Events.BUTTON_PRESS:\n\t\t\ttrackingData.plugin = params.plugin?.name || null;\n\t\t}\n\n\t\tconst context = this.config.context || \"userTracking\";\n\t\tawait this.player.data.write(\n\t\t\tcontext,\n\t\t\t{ id },\n\t\t\ttrackingData\n\t\t);\n\t}\n}\n","var map = {\n\t\"./UserTrackingPlugins.js\": 263,\n\t\"./es.upv.paella.analytics.userTrackingDataPlugin.js\": 561,\n\t\"./es.upv.paella.debug.userTrackingDataPlugin.js\": 931,\n\t\"./es.upv.paella.debugTag.userTrackingDataPlugin.js\": 484,\n\t\"./es.upv.paella.matomo.userTrackingDataPlugin.js\": 685,\n\t\"./es.upv.paella.userEventTracker.js\": 11\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 757;","module.exports = __WEBPACK_EXTERNAL_MODULE__995__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\nimport GoogleAnalyticsUserTrackingData from './plugins/es.upv.paella.analytics.userTrackingDataPlugin';\nimport MatomoUserTrackingData from './plugins/es.upv.paella.matomo.userTrackingDataPlugin';\nimport DebugUserTrackingData from './plugins/es.upv.paella.debug.userTrackingDataPlugin';\nimport UserEventTracker from './plugins/es.upv.paella.userEventTracker';\n\nexport default function getUserTrackingPluginsContext() {\n    return require.context(\"./plugins\", true, /\\.js/)\n}\n\nexport const GoogleAnalyticsUserTrackingDataPlugin = GoogleAnalyticsUserTrackingData;\nexport const MatomoUserTrackingDataPlugin = MatomoUserTrackingData;\nexport const DebugUserTrackingDataPlugin = DebugUserTrackingData;\nexport const UserEventTrackerPlugin = UserEventTracker;\n"],"names":["root","factory","exports","module","require","define","amd","undefined","self","__WEBPACK_EXTERNAL_MODULE__995__","UserTrackingPlugins","PluginModule","i","AnalyticsUserTrackingDataPlugin","trackingId","this","config","domain","player","log","debug","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","document","__gaTracker","context","data","id","category","action","event","labelData","videoId","plugin","JSON","stringify","params","e","label","DataPlugin","DebugUserTrackingDataPlugin","console","DebugTagTrackingDataPlugin","tagId","_elem","getElementById","innerHTML","MatomoUserTrackingDataPlugin","matomoGlobalLoaded","server","siteId","events","warn","getTemplateVars","templateVars","customDimensions","Object","entries","forEach","customDimensionId","customDimensionValueTemplate","customDimensionValue","applyTemplate","_paq","eventData","getEventData","_videoId","metadata","videoManifest","Events","Math","round","newTime","volume","name","size","w","h","layoutId","newPlaybackRate","language","heartBeatTime","bindEvent","cookieConsent","getConsentForType","cookieType","trackCustomDimensions","getCurrentUserId","userId","u","d","type","txt","replace","t","substring","length","split","reduce","b","categoryT","actionT","nameT","UserEventTrackerPlugin","map","eventName","trackingData","write","EventLogPlugin","webpackContext","req","webpackContextResolve","__webpack_require__","Error","code","keys","resolve","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","definition","key","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","getUserTrackingPluginsContext","GoogleAnalyticsUserTrackingDataPlugin","GoogleAnalyticsUserTrackingData","MatomoUserTrackingData","DebugUserTrackingData","UserEventTracker"],"sourceRoot":""}