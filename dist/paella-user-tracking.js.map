{"version":3,"file":"paella-user-tracking.js","mappings":"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","sources":["webpack://paella-user-tracking/webpack/universalModuleDefinition","webpack://paella-user-tracking/./src/plugins/UserTrackingPlugins.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.analytics.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.debug.userTrackingDataPlugin.js","webpack://paella-user-tracking/./src/plugins/es.upv.paella.userEventTracker.js","webpack://paella-user-tracking//home/fernando/desarrollo/paella/paella-user-tracking/src/plugins|sync|/\\.js/","webpack://paella-user-tracking/external umd {\"commonjs\":\"paella-core\",\"commonjs2\":\"paella-core\",\"amd\":\"paella-core\"}","webpack://paella-user-tracking/webpack/bootstrap","webpack://paella-user-tracking/webpack/runtime/compat get default export","webpack://paella-user-tracking/webpack/runtime/define property getters","webpack://paella-user-tracking/webpack/runtime/hasOwnProperty shorthand","webpack://paella-user-tracking/webpack/runtime/make namespace object","webpack://paella-user-tracking/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"paella-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"paella-core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"paella-user-tracking\"] = factory(require(\"paella-core\"));\n\telse\n\t\troot[\"paella-user-tracking\"] = factory(root[undefined]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__995__) {\nreturn ","import {Â PluginModule } from \"paella-core\";\nimport packageData from \"../../package.json\";\n\nexport default class UserTrackingPlugins extends PluginModule {\n    get moduleName() {\n        return \"paella-user-tracking\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","\nimport { DataPlugin  } from \"paella-core\";\n\nexport default class AnalyticsUserTrackingDataPlugin extends DataPlugin {\n    async load() {\n        const trackingId = this.config.trackingId;\n        const domain = this.config.domain || \"auto\";\n        if (trackingId) {\n            this.player.log.debug(\"Google Analytics Enabled\");\n            /* jshint ignore:start */\n            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n                (i[r].q=i[r].q||[]).push(arguments);},i[r].l=1*new Date();a=s.createElement(o),\n                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n                })(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');\n            /* jshint ignore:end */\n            __gaTracker('create', trackingId, domain);\n            __gaTracker('send', 'pageview');\n        }\n        else {\n            this.player.log.debug(\"No Google Tracking ID found in config file. Disabling Google Analytics\");\n        }\n    }\n    \n    async write(context, { id }, data) {\n        if (this.config.category === undefined || this.config.category === true) {\n            const category = this.config.category || \"PaellaPlayer\";\n            const action = data.event;\n            const labelData = {\n                videoId: id,\n                plugin: data.plugin\n            }\n\n            try {\n                // Test if data parameters can be serialized\n                JSON.stringify(data.params);\n                labelData.params = data.params;\n            }\n            catch(e) {}\n\n            const label = JSON.stringify(labelData);\n\n            __gaTracker(' send', 'event', category, action, label);\n        }\n    }\n}","\nimport { DataPlugin } from 'paella-core';\n\nexport default class DebugUserTrackingDataPlugin extends DataPlugin {\n    async write(context, { id }, data) {\n        console.log(`id: ${ id }`, context, data);\n    }\n}\n","import { Events, EventLogPlugin } from 'paella-core';\n\n//const eventKeys = Object.keys(Events);\n\nconst getPaellaEvents = (events) => events.map(eventName => Events[eventName]);\n\nexport default class UserEventTrackerPlugin extends EventLogPlugin {\n\tget events() {\n\t\tif (this.config.events) {\n\t\t\treturn getPaellaEvents(this.config.events);\n\t\t}\n\t\telse {\n\t\t\treturn [\n\t\t\t\tEvents.PLAY,\n\t\t\t\tEvents.PAUSE,\n\t\t\t\tEvents.SEEK,\n\t\t\t\tEvents.STOP,\n\t\t\t\tEvents.ENDED,\n\t\t\t\tEvents.FULLSCREEN_CHANGED,\n\t\t\t\tEvents.VOLUME_CHANGED,\n\t\t\t\tEvents.BUTTON_PRESS,\n\t\t\t\tEvents.RESIZE_END\n\t\t\t]\n\t\t}\n\t}\n\n\tasync onEvent(event, params) {\n\t\tconst id = this.player.videoId;\n\t\t// Remove plugin reference to avoid circular references\n\t\tif (params.plugin) {\n\t\t\tconst { name, config } = params.plugin;\n\t\t\tparams.plugin = { name, config }\n\t\t}\n\t\tconst trackingData = { event, params }\n\n\t\tswitch (event) {\n\t\tcase Events.SHOW_POPUP:\n\t\tcase Events.HIDE_POPUP:\n\t\tcase Events.BUTTON_PRESS:\n\t\t\ttrackingData.plugin = params.plugin?.name || null;\n\t\t}\n\n\t\tconst context = this.config.context || \"userTracking\";\n\t\tawait this.player.data.write(\n\t\t\tcontext,\n\t\t\t{ id },\n\t\t\ttrackingData\n\t\t);\n\t}\n}\n","var map = {\n\t\"./UserTrackingPlugins.js\": 263,\n\t\"./es.upv.paella.analytics.userTrackingDataPlugin.js\": 561,\n\t\"./es.upv.paella.debug.userTrackingDataPlugin.js\": 931,\n\t\"./es.upv.paella.userEventTracker.js\": 11\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 757;","module.exports = __WEBPACK_EXTERNAL_MODULE__995__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\nimport GoogleAnalyticsUserTrackingData from './plugins/es.upv.paella.analytics.userTrackingDataPlugin';\nimport DebugUserTrackingData from './plugins/es.upv.paella.debug.userTrackingDataPlugin';\nimport UserEventTracker from './plugins/es.upv.paella.userEventTracker';\n\nexport default function getUserTrackingPluginsContext() {\n    return require.context(\"./plugins\", true, /\\.js/)\n}\n\nexport const GoogleAnalyticsUserTrackingDataPlugin = GoogleAnalyticsUserTrackingData;\nexport const DebugUserTrackingDataPlugin = DebugUserTrackingData;\nexport const UserEventTrackerPlugin = UserEventTracker;\n"],"names":["root","factory","exports","module","require","define","amd","undefined","self","__WEBPACK_EXTERNAL_MODULE__995__","UserTrackingPlugins","PluginModule","AnalyticsUserTrackingDataPlugin","trackingId","this","config","domain","player","log","debug","i","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","document","__gaTracker","context","data","id","category","action","event","labelData","videoId","plugin","JSON","stringify","params","e","label","DataPlugin","DebugUserTrackingDataPlugin","console","UserEventTrackerPlugin","events","map","eventName","Events","name","trackingData","write","EventLogPlugin","webpackContext","req","webpackContextResolve","__webpack_require__","Error","code","keys","Object","resolve","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","definition","key","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","getUserTrackingPluginsContext","GoogleAnalyticsUserTrackingDataPlugin","GoogleAnalyticsUserTrackingData","DebugUserTrackingData","UserEventTracker"],"sourceRoot":""}